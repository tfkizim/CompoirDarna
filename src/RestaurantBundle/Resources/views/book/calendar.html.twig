[
    {% set chaine='' %}
    {% for book in books %}
        {% set color="#81c784" %}
        {% if book.stateId %}
            {% if book.stateId.function == "reserved" %}
                {% set color="#81c784" %}
            {% elseif book.stateId.function == "seated" %}
                {% set color="#64b5f6" %}
            {% elseif book.stateId.function == "late" %}
                {% set color="#ffb74d" %}
            {% elseif book.stateId.function == "free" %}
                {% set color="#e0e0e0" %}
            {% elseif book.stateId.function == "cancelled" %}
                {% set color="#e57373" %}
            {% elseif book.stateId.function == "pending" %}
                {% set color="#fff176" %}
            {% elseif book.stateId.function == "noshow" %}
                {% set color="#f44336" %}
            {% endif %}
        {% endif %}
        {% set title="" %}
        {% if book.customerId %}
            {% set title=book.customerId.sexe~' '~book.customerId.lastName~' '~book.customerId.firstName %}
        {% endif %}
        {% set chaine = chaine~'{
            "id":'~book.id~',
            "title":"'~title~'",
            "start":"'~(book.dateBook|date("Y-m-d H:i:s"))~'",
            "end":"'~(book.dateBook|date("Y-m-d H:i:s"))~'",
            "url":"'~url('book_detail',{id:book.id})~'",
            "color":"'~color~'"
        },' %}
    {% endfor %}
    {{ chaine|slice(0,-1)|raw }}
]